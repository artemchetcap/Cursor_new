# –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ MVP: Smart Summarizer Bot

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
**–î–∞—Ç–∞:** 03.12.2025
**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å MVP Telegram-–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Å—ã–ª–∫–∏ (YouTube, Web) –∏–ª–∏ —Ç–µ–∫—Å—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∞–º–º–∞—Ä–∏ –∏ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –°—Ç–µ–∫ (–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)

–ù–∞ –æ—Å–Ω–æ–≤–µ `Tech.md` –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª:
*   **–Ø–∑—ã–∫:** Python 3.11+.
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫ –±–æ—Ç–∞:** `aiogram 3.x`.
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) + Tortoise ORM (—Å–æ–≥–ª–∞—Å–Ω–æ `user_rules`) + Aerich (–º–∏–≥—Ä–∞—Ü–∏–∏).
*   **LLM:** OpenAI API (`gpt-5.1`) / Anthropic API (`claude-3-haiku`).
*   **–ü–∞—Ä—Å–∏–Ω–≥:** `yt-dlp` (YouTube), `newspaper3k` (Web), `BeautifulSoup4`.
*   **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:** Docker Compose.
*   **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:** –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ –ø–∞–ø–∫–µ `dogs/`.

---

## 2. –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ë–∞–∑–æ–≤–∞—è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚úÖ
**–¶–µ–ª—å:** –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –ø—Ä–æ–µ–∫—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –ë–î.

1.  **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**:
    *   –°–æ–∑–¥–∞—Ç—å –¥–µ—Ä–µ–≤–æ –ø–∞–ø–æ–∫ —Å–æ–≥–ª–∞—Å–Ω–æ `Tech.md` (`app/bot`, `app/core`, `app/database`).
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `.gitignore`, `requirements.txt` / `pyproject.toml`.
2.  **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**:
    *   –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `app/core/config.py` (Pydantic settings) –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (`TG_TOKEN`, `OPENAI_API_KEY`, `ADMIN_IDS`).
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`structlog`).
3.  **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Tortoise ORM)**:
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SQLite.
    *   –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å **`User`** (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏):
        *   `id` (PK): –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä.
        *   `telegram_id`: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –≤ Telegram (BigInt).
        *   `username`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (@username).
        *   `full_name`: –ü–æ–ª–Ω–æ–µ –∏–º—è.
        *   `created_at`: –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.
    *   –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å **`SummaryRequest`** (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞):
        *   `id` (PK): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞.
        *   `user_id` (FK): –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
        *   `content_type`: –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (youtube, article, text, file).
        *   `source_url`: –°—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫ (–∏–ª–∏ null –¥–ª—è —Ç–µ–∫—Å—Ç–∞).
        *   `status`: –†–µ–∑—É–ª—å—Ç–∞—Ç (success, error, processing).
        *   `tokens_used`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ (cost).
        *   `error_message`: –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å error).
        *   `created_at`: –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞.
    *   –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `Aerich` –∏ —Å–æ–∑–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é.

### –≠—Ç–∞–ø 2: Core Logic (ETL Pipeline) ‚úÖ
**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–º–º–∞—Ä–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ç Telegram.

4.  **–ú–æ–¥—É–ª—å –ø–∞—Ä—Å–∏–Ω–≥–∞ (`app/core/parsers/`)**:
    *   `BaseParser`: –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å.
    *   `YouTubeParser`: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `yt-dlp` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—É–±—Ç–∏—Ç—Ä–æ–≤ (vtt/srt -> text).
    *   `WebParser`: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `newspaper3k` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—å–∏.
    *   `Router`: –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ URL/—Å–æ–æ–±—â–µ–Ω–∏—é.
5.  **LLM –°–µ—Ä–≤–∏—Å (`app/core/llm/`)**:
    *   –ö–ª–∏–µ–Ω—Ç –¥–ª—è OpenAI/Anthropic.
    *   –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç "Deep Analysis" (—Å–æ–≥–ª–∞—Å–Ω–æ `Product.md`).
    *   –ü–æ–¥—Å—á–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ (input/output) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É.

### –≠—Ç–∞–ø 3: Telegram Bot Interface & Admin Tools ‚úÖ
**–¶–µ–ª—å:** –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

6.  **Setup Aiogram**:
    *   –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `Dispatcher` –∏ `Bot`.
    *   Middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `User` –≤ –ë–î –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏.
7.  **User Handlers (CJM Implementation)**:
    *   `/start` (Onboarding): –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ–º —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–∑—ã–≤–æ–º –∫ –¥–µ–π—Å—Ç–≤–∏—é ("–û—Ç–ø—Ä–∞–≤—å –º–Ω–µ —Å—Å—ã–ª–∫—É").
    *   `Message Handler`:
        *   –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä—è–º—ã—Ö —Å—Å—ã–ª–æ–∫ –∏ **Forwarded Messages**.
        *   UX: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "Typing..." –∏–ª–∏ "üëÄ –ò–∑—É—á–∞—é –º–∞—Ç–µ—Ä–∏–∞–ª..." –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.
        *   UX: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Footer-–∞ –≤ —Å–∞–º–º–∞—Ä–∏ ("‚ö°Ô∏è Fast read with @BotName").
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö (–Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è —Å—Å—ã–ª–∫–∞, –∑–∞–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø).
8.  **Admin Handlers (–ê–Ω–∞–ª–∏—Ç–∏–∫–∞)**:
    *   –ö–æ–º–∞–Ω–¥–∞ `/stats`: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–¥–∫—É –∑–∞ 24—á/–Ω–µ–¥–µ–ª—é (–Ω–æ–≤—ã—Ö —é–∑–µ—Ä–æ–≤, –∫–æ–ª-–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞—Ç—Ä–∞—Ç—ã). –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è `ADMIN_IDS`.
    *   –ö–æ–º–∞–Ω–¥–∞ `/export`: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `.csv` —Ñ–∞–π–ª —Å –≤—ã–≥—Ä—É–∑–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã `SummaryRequest`.

### –≠—Ç–∞–ø 4: Docker & Deployment ‚úÖ
**–¶–µ–ª—å:** –£–ø–∞–∫–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞.

9.  ‚úÖ **Dockerfile**: –ú—É–ª—å—Ç–∏—Å—Ç–µ–π–¥–∂ —Å–±–æ—Ä–∫–∞ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
10. ‚úÖ **docker-compose.yml**: –°–µ—Ä–≤–∏—Å –±–æ—Ç–∞ + `.dockerignore`.

---

## 3. –†–∏—Å–∫–∏ –∏ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏

*   **–†–∏—Å–∫:** `yt-dlp` –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏. *–ú–∏—Ç–∏–≥–∞—Ü–∏—è:* Cookies/Proxy.
*   **–†–∏—Å–∫:** –í—ã—Å–æ–∫–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å API. *–ú–∏—Ç–∏–≥–∞—Ü–∏—è:* –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ `/stats`, –ª–∏–º–∏—Ç—ã –¥–ª—è —é–∑–µ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

---

## 4. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (Definition of Done)

1.  –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ.
2.  **Onboarding:** –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ `/start`.
3.  **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** –°–∞–º–º–∞—Ä–∏ –¥–ª—è YouTube –∏ –°—Ç–∞—Ç–µ–π (–≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è).
4.  **UX:** –ï—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã (Typing) –∏ –±—Ä–µ–Ω–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—É—Ç–µ—Ä.
5.  **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:** –í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å, –µ—Å—Ç—å –≤—ã–≥—Ä—É–∑–∫–∞ CSV.
